namespace SpriteKind {
    export const Target = SpriteKind.create()
}
scene.onOverlapTile(SpriteKind.Player, myTiles.tile2, function (sprite, location) {
    if (falcon.vy > crashSpeed) {
        game.over(false)
    } else {
        game.over(true)
    }
})
scene.onOverlapTile(SpriteKind.Player, myTiles.tile4, function (sprite, location) {
    game.over(false)
})
let falcon: Sprite = null
let crashSpeed = 0
crashSpeed = 300
tiles.setTilemap(tiles.createTilemap(hex`100080000101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020303030303030303030303030303030302020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020303030303030303030303030303030302020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020303030303030303030303030303030302020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202030303030303030303030303030303030202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020303030303030303030303030303020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020203030303030303030303030303030202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020303030303030303030303030303020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020203030303030303030303030303020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020303030303030202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020303030303030303030303030202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020303030303030303030303030202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020203030303030303030303030303020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202030303030303030303030303030202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202030303030303030303030303030302020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020203030303030303030303030302020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020203030303030303030303030302020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202040404040404020202020205050505050505050505050505050505`, img`
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    `, [myTiles.transparency16,sprites.dungeon.darkGroundCenter,myTiles.tile1,myTiles.tile3,myTiles.tile2,myTiles.tile4], TileScale.Sixteen))
falcon = sprites.create(img`
    . . . . . . . f . . . . . . . . 
    . . . . . . f 1 f . . . . . . . 
    . . . . . f 1 1 1 f . . . . . . 
    . . . . . f 1 f 1 f . . . . . . 
    . . . . . f 1 1 1 f . . . . . . 
    . . . . . f 1 1 1 f . . . . . . 
    . . . . . f f 1 f f . . . . . . 
    . . . . . f 1 f 1 f . . . . . . 
    . . . . . f 1 1 1 f . . . . . . 
    . . . . . f 1 1 1 f . . . . . . 
    . . . . . f f 1 f f . . . . . . 
    . . . . . f 1 f 1 f . . . . . . 
    . . . . . f 1 1 1 f . . . . . . 
    . . . . f 4 f f f 4 f . . . . . 
    . . . f . . 4 f 4 . . f . . . . 
    . . f . . . . f . . . . f . . . 
    `, SpriteKind.Player)
scene.cameraFollowSprite(falcon)
let landingView = sprites.create(img`
    ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
    f88888888888888888888888888888888888888888888888888888888888888f
    f88888888888888888888888888888888888888888888888888888888888888f
    f88888888888888888888888888888888888888888888888888888888888888f
    f88888888888888888888888888888888888888888888888888888888888888f
    f88888888888888888888888888888888888888888888888888888888888888f
    f88888888888888888888888888888888888888888888888888888888888888f
    f88888888888888888888888888888888888888888888888888888888888888f
    f88888888888888888888888888888888888888888888888888888888888888f
    f88888888888888888888888888888888888888888888888888888888888888f
    f88888888888888888888888888888888888888888888888888888888888888f
    f88888888888888888888bbbbbbbbbbbbbbbbbbbbbbb8888888888888888888f
    f88888888888888888888bbbbbbbbbbbbbbbbbbbbbbb8888888888888888888f
    f88888888888888888888bbbbbbbbbbbbbbbbbbbbbbb8888888888888888888f
    f88888888888888888888bbbbbbbbbbbbbbbbbbbbbbb8888888888888888888f
    ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
    f88888888888888888888bbbbbbbbbbbbbbbbbbbbbbb8888888888888888888f
    f88888888888888888888bbbbbbbbbbbbbbbbbbbbbbb8888888888888888888f
    f88888888888888888888bbbbbbbbbbbbbbbbbbbbbbb8888888888888888888f
    f88888888888888888888bbbbbbbbbbbbbbbbbbbbbbb8888888888888888888f
    f88888888888888888888888888888888888888888888888888888888888888f
    f88888888888888888888888888888888888888888888888888888888888888f
    f88888888888888888888888888888888888888888888888888888888888888f
    f88888888888888888888888888888888888888888888888888888888888888f
    f88888888888888888888888888888888888888888888888888888888888888f
    f88888888888888888888888888888888888888888888888888888888888888f
    f88888888888888888888888888888888888888888888888888888888888888f
    f88888888888888888888888888888888888888888888888888888888888888f
    f88888888888888888888888888888888888888888888888888888888888888f
    f88888888888888888888888888888888888888888888888888888888888888f
    ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
    `, SpriteKind.Player)
landingView.setFlag(SpriteFlag.RelativeToCamera, true)
landingView.right = scene.screenWidth()
landingView.bottom = scene.screenHeight()
let target = sprites.create(img`
    . . . . f . . . . 
    . . . . f . . . . 
    . . . . f . . . . 
    . . . . f . . . . 
    . . . . f . . . . 
    . . . . f . . . . 
    . . . . f . . . . 
    . . . . f . . . . 
    . . . . f . . . . 
    . . . . f . . . . 
    . . . . f . . . . 
    . . . . f . . . . 
    . . . . f . . . . 
    . . . . f . . . . 
    . . . . f . . . . 
    . . . . f . . . . 
    . . . . f . . . . 
    . . . . f . . . . 
    . . . . f . . . . 
    . . . . f . . . . 
    . . . . f . . . . 
    . . . . f . . . . 
    . . . . f . . . . 
    . . . . f . . . . 
    . . . . f . . . . 
    . . . . f . . . . 
    . . . . f . . . . 
    . . . . f . . . . 
    . . . . f . . . . 
    . . . . f . . . . 
    . . . . f . . . . 
    `, SpriteKind.Target)
target.setFlag(SpriteFlag.RelativeToCamera, true)
target.setPosition(landingView.x, landingView.y)
let altitude = textsprite.create("Alt:", 15, 1)
altitude.setBorder(1, 15, 1)
altitude.setFlag(SpriteFlag.RelativeToCamera, true)
altitude.bottom = landingView.top
altitude.left = landingView.left
let speed = textsprite.create("Spd:", 15, 1)
speed.setBorder(1, 15, 1)
speed.setFlag(SpriteFlag.RelativeToCamera, true)
speed.bottom = altitude.top
speed.left = altitude.left
game.onUpdateInterval(500, function () {
    falcon.vx = Math.constrain(controller.acceleration(ControllerDimension.X), -50, 50)
    if (controller.A.isPressed()) {
        falcon.ay = -100
    } else {
        falcon.ay = 100
    }
})
game.onUpdateInterval(100, function () {
    target.x = Math.map(falcon.x, 0, 256, scene.screenWidth() - landingView.width, scene.screenWidth())
    altitude.setText("Alt:" + Math.map(scene.cameraProperty(CameraProperty.Y), 0, 1988, 1988, 0))
    speed.setText("Spd:" + Math.ceil(falcon.vy))
    if (falcon.vy > crashSpeed) {
        speed.setBorder(1, 2, 1)
    } else {
        speed.setBorder(1, 15, 1)
    }
})
